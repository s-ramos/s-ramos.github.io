{"version":3,"sources":["webpack:///node_modules/@firebase/analytics/dist/index.esm.js","webpack:///node_modules/@firebase/analytics/node_modules/tslib/tslib.es6.js","webpack:///node_modules/@firebase/installations/dist/index.esm.js","webpack:///node_modules/@firebase/installations/node_modules/tslib/tslib.es6.js","webpack:///node_modules/firebase/analytics/dist/index.esm.js","webpack:///node_modules/idb/build/idb.js"],"names":["ANALYTICS_ID_FIELD","GA_FID_KEY","ORIGIN_KEY","GTAG_URL","GtagCommand","EventName","logEvent","gtagFunction","analyticsId","eventName","eventParams","options","params","global","EVENT","setCurrentScreen","screenName","SET","CONFIG","update","setUserId","id","setUserProperties","properties","flatProperties","_i","_a","Object","keys","length","key","setAnalyticsCollectionEnabled","enabled","window","logger","initializeGAId","app","installations","gtagCore","fid","_b","label","getId","sent","Date","insertScriptTag","dataLayerName","script","document","createElement","src","async","head","appendChild","getOrCreateDataLayer","dataLayer","Array","isArray","wrapGtag","initializedIdPromisesMap","command","idOrNameOrParams","gtagParams","initializationPromisesToWaitFor","gaSendToList","gaSendToList_1","sendToId","initializationPromise","push","values","idPromise","Promise","all","then","e","error","initializationPromiseToWait","resolve","wrapOrCreateGtag","gtagFunctionName","_args","arguments","wrappedGtag","findGtagScriptOnPage","scriptTags","getElementsByTagName","tag","includes","ERRORS","ERROR_FACTORY","gtagName","gtagCoreFunction","wrappedGtagFunction","globalInitDone","resetGlobalVars","newGlobalInitDone","newGaInitializedPromise","getGlobalVars","settings","create","factory","analyticsInstance","name","version","ANALYTICS_TYPE","registerAnalytics","instance","INTERNAL","registerComponent","container","getProvider","getImmediate","setServiceProps","internalFactory","registerVersion","analytics","reason","extendStatics","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","prototype","__assign","assign","t","s","i","n","call","apply","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","adopt","value","reject","fulfilled","step","next","rejected","result","done","__generator","body","_","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","__exportStar","m","exports","__values","o","__read","ar","__spread","concat","__spreadArrays","il","k","a","j","jl","__await","__asyncGenerator","asyncIterator","q","resume","settle","fulfill","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","__esModule","__importDefault","__classPrivateFieldGet","receiver","privateMap","has","get","__classPrivateFieldSet","set","PENDING_TIMEOUT_MS","PACKAGE_VERSION","INTERNAL_AUTH_VERSION","INSTALLATIONS_API_URL","TOKEN_EXPIRATION_BUFFER","SERVICE","SERVICE_NAME","ERROR_DESCRIPTION_MAP","isServerError","code","getInstallationsEndpoint","projectId","extractAuthTokenInfoFromResponse","response","token","requestStatus","expiresIn","getExpiresInFromResponseExpiresIn","creationTime","now","getErrorFromResponse","requestName","responseJson","errorData","json","serverCode","serverMessage","message","serverStatus","status","getHeaders","apiKey","Headers","Accept","getHeadersWithAuth","appConfig","refreshToken","headers","append","getAuthorizationHeader","retryIfServerError","fn","responseExpiresIn","Number","replace","createInstallationRequest","endpoint","request","responseValue","registeredInstallationEntry","authVersion","appId","sdkVersion","method","JSON","stringify","fetch","ok","registrationStatus","authToken","sleep","ms","setTimeout","bufferToBase64UrlSafe","array","b64","btoa","String","fromCharCode","VALID_FID_PATTERN","INVALID_FID","generateFid","fidByteArray","Uint8Array","crypto_1","self","crypto","msCrypto","getRandomValues","encode","test","b64String","substr","getKey","appName","fidChangeCallbacks","Map","fidChanged","callFidChangeCallbacks","broadcastFidChange","addCallback","callback","getBroadcastChannel","callbackSet","Set","add","removeCallback","size","closeBroadcastChannel","e_1","callbacks","callbacks_1","callbacks_1_1","e_1_1","channel","postMessage","broadcastChannel","BroadcastChannel","onmessage","data","close","DATABASE_NAME","DATABASE_VERSION","OBJECT_STORE_NAME","dbPromise","getDbPromise","upgradeDB","oldVersion","createObjectStore","db","tx","objectStore","oldValue","transaction","put","complete","remove","updateFn","store","newValue","undefined","getInstallationEntry","registrationPromise","installationEntry","oldEntry","updateOrCreateInstallationEntry","entryWithPromise","triggerRegistrationIfNecessary","entry","clearTimedOutRequest","navigator","onLine","registrationPromiseWithError","inProgressEntry","registrationTime","registerInstallation","waitUntilFidRegistration","updateInstallationRequest","hasInstallationRequestTimedOut","generateAuthTokenRequest","platformLoggerProvider","platformLogger","completedAuthToken","getGenerateAuthTokenEndpoint","optional","getPlatformInfoString","installation","refreshAuthToken","dependencies","forceRefresh","tokenPromise","isEntryRegistered","oldAuthToken","isAuthTokenValid","waitUntilAuthTokenRequest","makeAuthTokenRequestInProgressEntry","fetchAuthTokenFromServer","updateAuthTokenRequest","hasAuthTokenRequestTimedOut","updatedInstallationEntry","isAuthTokenExpired","inProgressAuthToken","requestTime","console","getToken","completeInstallationRegistration","deleteInstallationRequest","getDeleteEndpoint","deleteInstallation","onIdChange","extractAppConfig","getMissingValueError","configKeys","configKeys_1","configKeys_1_1","keyName","valueName","registerInstallations","installationsName","toArray","arr","slice","promisifyRequest","onsuccess","onerror","promisifyRequestCall","obj","args","promisifyCursorRequestCall","Cursor","proxyProperties","ProxyClass","targetProp","forEach","prop","val","proxyRequestMethods","Constructor","proxyMethods","proxyCursorRequestMethods","Index","index","_index","IDBIndex","cursor","_cursor","_request","IDBCursor","methodName","ObjectStore","_store","createIndex","IDBObjectStore","Transaction","idbTransaction","_tx","oncomplete","onabort","IDBTransaction","UpgradeDB","_db","IDBDatabase","DB","funcName","nativeObject","getAll","query","count","items","iterateCursor","openDb","upgradeCallback","indexedDB","onupgradeneeded","event","deleteDb"],"mappings":"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","file":"firebase-analytics-es5.js","sourcesContent":["import firebase from '@firebase/app';\nimport '@firebase/installations';\nimport { __assign, __awaiter, __generator } from 'tslib';\nimport { Logger } from '@firebase/logger';\nimport { ErrorFactory } from '@firebase/util';\nimport { Component } from '@firebase/component';\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar ANALYTICS_ID_FIELD = 'measurementId';\r\n// Key to attach FID to in gtag params.\r\nvar GA_FID_KEY = 'firebase_id';\r\nvar ORIGIN_KEY = 'origin';\r\nvar GTAG_URL = 'https://www.googletagmanager.com/gtag/js';\r\nvar GtagCommand;\r\n(function (GtagCommand) {\r\n    GtagCommand[\"EVENT\"] = \"event\";\r\n    GtagCommand[\"SET\"] = \"set\";\r\n    GtagCommand[\"CONFIG\"] = \"config\";\r\n})(GtagCommand || (GtagCommand = {}));\r\n/*\r\n * Officially recommended event names for gtag.js\r\n * Any other string is also allowed.\r\n */\r\nvar EventName;\r\n(function (EventName) {\r\n    EventName[\"ADD_SHIPPING_INFO\"] = \"add_shipping_info\";\r\n    EventName[\"ADD_PAYMENT_INFO\"] = \"add_payment_info\";\r\n    EventName[\"ADD_TO_CART\"] = \"add_to_cart\";\r\n    EventName[\"ADD_TO_WISHLIST\"] = \"add_to_wishlist\";\r\n    EventName[\"BEGIN_CHECKOUT\"] = \"begin_checkout\";\r\n    /** @deprecated */\r\n    EventName[\"CHECKOUT_PROGRESS\"] = \"checkout_progress\";\r\n    EventName[\"EXCEPTION\"] = \"exception\";\r\n    EventName[\"GENERATE_LEAD\"] = \"generate_lead\";\r\n    EventName[\"LOGIN\"] = \"login\";\r\n    EventName[\"PAGE_VIEW\"] = \"page_view\";\r\n    EventName[\"PURCHASE\"] = \"purchase\";\r\n    EventName[\"REFUND\"] = \"refund\";\r\n    EventName[\"REMOVE_FROM_CART\"] = \"remove_from_cart\";\r\n    EventName[\"SCREEN_VIEW\"] = \"screen_view\";\r\n    EventName[\"SEARCH\"] = \"search\";\r\n    EventName[\"SELECT_CONTENT\"] = \"select_content\";\r\n    EventName[\"SELECT_ITEM\"] = \"select_item\";\r\n    EventName[\"SELECT_PROMOTION\"] = \"select_promotion\";\r\n    /** @deprecated */\r\n    EventName[\"SET_CHECKOUT_OPTION\"] = \"set_checkout_option\";\r\n    EventName[\"SHARE\"] = \"share\";\r\n    EventName[\"SIGN_UP\"] = \"sign_up\";\r\n    EventName[\"TIMING_COMPLETE\"] = \"timing_complete\";\r\n    EventName[\"VIEW_CART\"] = \"view_cart\";\r\n    EventName[\"VIEW_ITEM\"] = \"view_item\";\r\n    EventName[\"VIEW_ITEM_LIST\"] = \"view_item_list\";\r\n    EventName[\"VIEW_PROMOTION\"] = \"view_promotion\";\r\n    EventName[\"VIEW_SEARCH_RESULTS\"] = \"view_search_results\";\r\n})(EventName || (EventName = {}));\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Logs an analytics event through the Firebase SDK.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param eventName Google Analytics event name, choose from standard list or use a custom string.\r\n * @param eventParams Analytics event parameters.\r\n */\r\nfunction logEvent(gtagFunction, analyticsId, eventName, eventParams, options) {\r\n    var params = eventParams || {};\r\n    if (!options || !options.global) {\r\n        params = __assign(__assign({}, eventParams), { 'send_to': analyticsId });\r\n    }\r\n    // Workaround for http://b/141370449 - third argument cannot be undefined.\r\n    gtagFunction(GtagCommand.EVENT, eventName, params || {});\r\n}\r\n// TODO: Brad is going to add `screen_name` to GA Gold config parameter schema\r\n/**\r\n * Set screen_name parameter for this Google Analytics ID.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param screenName Screen name string to set.\r\n */\r\nfunction setCurrentScreen(gtagFunction, analyticsId, screenName, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(GtagCommand.SET, { 'screen_name': screenName });\r\n    }\r\n    else {\r\n        gtagFunction(GtagCommand.CONFIG, analyticsId, {\r\n            update: true,\r\n            'screen_name': screenName\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set user_id parameter for this Google Analytics ID.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param id User ID string to set\r\n */\r\nfunction setUserId(gtagFunction, analyticsId, id, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(GtagCommand.SET, { 'user_id': id });\r\n    }\r\n    else {\r\n        gtagFunction(GtagCommand.CONFIG, analyticsId, {\r\n            update: true,\r\n            'user_id': id\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set all other user properties other than user_id and screen_name.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param properties Map of user properties to set\r\n */\r\nfunction setUserProperties(gtagFunction, analyticsId, properties, options) {\r\n    if (options && options.global) {\r\n        var flatProperties = {};\r\n        for (var _i = 0, _a = Object.keys(properties); _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            // use dot notation for merge behavior in gtag.js\r\n            flatProperties[\"user_properties.\" + key] = properties[key];\r\n        }\r\n        gtagFunction(GtagCommand.SET, flatProperties);\r\n    }\r\n    else {\r\n        gtagFunction(GtagCommand.CONFIG, analyticsId, {\r\n            update: true,\r\n            'user_properties': properties\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set whether collection is enabled for this ID.\r\n *\r\n * @param enabled If true, collection is enabled for this ID.\r\n */\r\nfunction setAnalyticsCollectionEnabled(analyticsId, enabled) {\r\n    window[\"ga-disable-\" + analyticsId] = !enabled;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar logger = new Logger('@firebase/analytics');\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Initialize the analytics instance in gtag.js by calling config command with fid.\r\n *\r\n * NOTE: We combine analytics initialization and setting fid together because we want fid to be\r\n * part of the `page_view` event that's sent during the initialization\r\n * @param app Firebase app\r\n * @param gtagCore The gtag function that's not wrapped.\r\n */\r\nfunction initializeGAId(app, installations, gtagCore) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var fid;\r\n        var _a;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, installations.getId()];\r\n                case 1:\r\n                    fid = _b.sent();\r\n                    // This command initializes gtag.js and only needs to be called once for the entire web app,\r\n                    // but since it is idempotent, we can call it multiple times.\r\n                    // We keep it together with other initialization logic for better code structure.\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    gtagCore('js', new Date());\r\n                    // It should be the first config command called on this GA-ID\r\n                    // Initialize this GA-ID and set FID on it using the gtag config API.\r\n                    gtagCore(GtagCommand.CONFIG, app.options[ANALYTICS_ID_FIELD], (_a = {},\r\n                        _a[GA_FID_KEY] = fid,\r\n                        // guard against developers accidentally setting properties with prefix `firebase_`\r\n                        _a[ORIGIN_KEY] = 'firebase',\r\n                        _a.update = true,\r\n                        _a));\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction insertScriptTag(dataLayerName) {\r\n    var script = document.createElement('script');\r\n    // We are not providing an analyticsId in the URL because it would trigger a `page_view`\r\n    // without fid. We will initialize ga-id using gtag (config) command together with fid.\r\n    script.src = GTAG_URL + \"?l=\" + dataLayerName;\r\n    script.async = true;\r\n    document.head.appendChild(script);\r\n}\r\n/** Get reference to, or create, global datalayer.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\")\r\n */\r\nfunction getOrCreateDataLayer(dataLayerName) {\r\n    // Check for existing dataLayer and create if needed.\r\n    var dataLayer = [];\r\n    if (Array.isArray(window[dataLayerName])) {\r\n        dataLayer = window[dataLayerName];\r\n    }\r\n    else {\r\n        window[dataLayerName] = dataLayer;\r\n    }\r\n    return dataLayer;\r\n}\r\n/**\r\n * Wraps a standard gtag function with extra code to wait for completion of\r\n * relevant initialization promises before sending requests.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer\r\n * @param initializedIdPromisesMap Map of gaIds to their initialization promises\r\n */\r\nfunction wrapGtag(gtagCore, initializedIdPromisesMap) {\r\n    return function (command, idOrNameOrParams, gtagParams) {\r\n        // If event, check that relevant initialization promises have completed.\r\n        if (command === GtagCommand.EVENT) {\r\n            var initializationPromisesToWaitFor = [];\r\n            // If there's a 'send_to' param, check if any ID specified matches\r\n            // a FID we have begun a fetch on.\r\n            if (gtagParams && gtagParams['send_to']) {\r\n                var gaSendToList = gtagParams['send_to'];\r\n                // Make it an array if is isn't, so it can be dealt with the same way.\r\n                if (!Array.isArray(gaSendToList)) {\r\n                    gaSendToList = [gaSendToList];\r\n                }\r\n                for (var _i = 0, gaSendToList_1 = gaSendToList; _i < gaSendToList_1.length; _i++) {\r\n                    var sendToId = gaSendToList_1[_i];\r\n                    var initializationPromise = initializedIdPromisesMap[sendToId];\r\n                    // Groups will not be in the map.\r\n                    if (initializationPromise) {\r\n                        initializationPromisesToWaitFor.push(initializationPromise);\r\n                    }\r\n                    else {\r\n                        // There is an item in 'send_to' that is not associated\r\n                        // directly with an FID, possibly a group.  Empty this array\r\n                        // and let it get populated below.\r\n                        initializationPromisesToWaitFor = [];\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // This will be unpopulated if there was no 'send_to' field , or\r\n            // if not all entries in the 'send_to' field could be mapped to\r\n            // a FID. In these cases, wait on all pending initialization promises.\r\n            if (initializationPromisesToWaitFor.length === 0) {\r\n                for (var _a = 0, _b = Object.values(initializedIdPromisesMap); _a < _b.length; _a++) {\r\n                    var idPromise = _b[_a];\r\n                    initializationPromisesToWaitFor.push(idPromise);\r\n                }\r\n            }\r\n            // Run core gtag function with args after all relevant initialization\r\n            // promises have been resolved.\r\n            Promise.all(initializationPromisesToWaitFor)\r\n                // Workaround for http://b/141370449 - third argument cannot be undefined.\r\n                .then(function () {\r\n                return gtagCore(GtagCommand.EVENT, idOrNameOrParams, gtagParams || {});\r\n            })\r\n                .catch(function (e) { return logger.error(e); });\r\n        }\r\n        else if (command === GtagCommand.CONFIG) {\r\n            var initializationPromiseToWait = initializedIdPromisesMap[idOrNameOrParams] ||\r\n                Promise.resolve();\r\n            initializationPromiseToWait\r\n                .then(function () {\r\n                gtagCore(GtagCommand.CONFIG, idOrNameOrParams, gtagParams);\r\n            })\r\n                .catch(function (e) { return logger.error(e); });\r\n        }\r\n        else {\r\n            // SET command.\r\n            // Splitting calls for CONFIG and SET to make it clear which signature\r\n            // Typescript is checking.\r\n            gtagCore(GtagCommand.SET, idOrNameOrParams);\r\n        }\r\n    };\r\n}\r\n/**\r\n * Creates global gtag function or wraps existing one if found.\r\n * This wrapped function attaches Firebase instance ID (FID) to gtag 'config' and\r\n * 'event' calls that belong to the GAID associated with this Firebase instance.\r\n *\r\n * @param initializedIdPromisesMap Map of gaId to initialization promises.\r\n * @param dataLayerName Name of global GA datalayer array.\r\n * @param gtagFunctionName Name of global gtag function (\"gtag\" if not user-specified)\r\n */\r\nfunction wrapOrCreateGtag(initializedIdPromisesMap, dataLayerName, gtagFunctionName) {\r\n    // Create a basic core gtag function\r\n    var gtagCore = function () {\r\n        var _args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            _args[_i] = arguments[_i];\r\n        }\r\n        // Must push IArguments object, not an array.\r\n        window[dataLayerName].push(arguments);\r\n    };\r\n    // Replace it with existing one if found\r\n    if (window[gtagFunctionName] &&\r\n        typeof window[gtagFunctionName] === 'function') {\r\n        // @ts-ignore\r\n        gtagCore = window[gtagFunctionName];\r\n    }\r\n    window[gtagFunctionName] = wrapGtag(gtagCore, initializedIdPromisesMap);\r\n    return {\r\n        gtagCore: gtagCore,\r\n        wrappedGtag: window[gtagFunctionName]\r\n    };\r\n}\r\n/**\r\n * Returns first script tag in DOM matching our gtag url pattern.\r\n */\r\nfunction findGtagScriptOnPage() {\r\n    var scriptTags = window.document.getElementsByTagName('script');\r\n    for (var _i = 0, _a = Object.values(scriptTags); _i < _a.length; _i++) {\r\n        var tag = _a[_i];\r\n        if (tag.src && tag.src.includes(GTAG_URL)) {\r\n            return tag;\r\n        }\r\n    }\r\n    return null;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar _a;\r\nvar ERRORS = (_a = {},\r\n    _a[\"no-ga-id\" /* NO_GA_ID */] = \"\\\"\" + ANALYTICS_ID_FIELD + \"\\\" field is empty in \" +\r\n        'Firebase config. Firebase Analytics ' +\r\n        'requires this field to contain a valid measurement ID.',\r\n    _a[\"already-exists\" /* ALREADY_EXISTS */] = 'A Firebase Analytics instance with the measurement ID ${id} ' +\r\n        ' already exists. ' +\r\n        'Only one Firebase Analytics instance can be created for each measurement ID.',\r\n    _a[\"already-initialized\" /* ALREADY_INITIALIZED */] = 'Firebase Analytics has already been initialized.' +\r\n        'settings() must be called before initializing any Analytics instance' +\r\n        'or it will have no effect.',\r\n    _a[\"interop-component-reg-failed\" /* INTEROP_COMPONENT_REG_FAILED */] = 'Firebase Analytics Interop Component failed to instantiate',\r\n    _a);\r\nvar ERROR_FACTORY = new ErrorFactory('analytics', 'Analytics', ERRORS);\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Maps gaId to FID fetch promises.\r\n */\r\nvar initializedIdPromisesMap = {};\r\n/**\r\n * Name for window global data layer array used by GA: defaults to 'dataLayer'.\r\n */\r\nvar dataLayerName = 'dataLayer';\r\n/**\r\n * Name for window global gtag function used by GA: defaults to 'gtag'.\r\n */\r\nvar gtagName = 'gtag';\r\n/**\r\n * Reproduction of standard gtag function or reference to existing\r\n * gtag function on window object.\r\n */\r\nvar gtagCoreFunction;\r\n/**\r\n * Wrapper around gtag function that ensures FID is sent with all\r\n * relevant event and config calls.\r\n */\r\nvar wrappedGtagFunction;\r\n/**\r\n * Flag to ensure page initialization steps (creation or wrapping of\r\n * dataLayer and gtag script) are only run once per page load.\r\n */\r\nvar globalInitDone = false;\r\n/**\r\n * For testing\r\n */\r\nfunction resetGlobalVars(newGlobalInitDone, newGaInitializedPromise) {\r\n    if (newGlobalInitDone === void 0) { newGlobalInitDone = false; }\r\n    if (newGaInitializedPromise === void 0) { newGaInitializedPromise = {}; }\r\n    globalInitDone = newGlobalInitDone;\r\n    initializedIdPromisesMap = newGaInitializedPromise;\r\n    dataLayerName = 'dataLayer';\r\n    gtagName = 'gtag';\r\n}\r\n/**\r\n * For testing\r\n */\r\nfunction getGlobalVars() {\r\n    return {\r\n        initializedIdPromisesMap: initializedIdPromisesMap\r\n    };\r\n}\r\n/**\r\n * This must be run before calling firebase.analytics() or it won't\r\n * have any effect.\r\n * @param options Custom gtag and dataLayer names.\r\n */\r\nfunction settings(options) {\r\n    if (globalInitDone) {\r\n        throw ERROR_FACTORY.create(\"already-initialized\" /* ALREADY_INITIALIZED */);\r\n    }\r\n    if (options.dataLayerName) {\r\n        dataLayerName = options.dataLayerName;\r\n    }\r\n    if (options.gtagName) {\r\n        gtagName = options.gtagName;\r\n    }\r\n}\r\nfunction factory(app, installations) {\r\n    var analyticsId = app.options[ANALYTICS_ID_FIELD];\r\n    if (!analyticsId) {\r\n        throw ERROR_FACTORY.create(\"no-ga-id\" /* NO_GA_ID */);\r\n    }\r\n    if (initializedIdPromisesMap[analyticsId] != null) {\r\n        throw ERROR_FACTORY.create(\"already-exists\" /* ALREADY_EXISTS */, {\r\n            id: analyticsId\r\n        });\r\n    }\r\n    if (!globalInitDone) {\r\n        // Steps here should only be done once per page: creation or wrapping\r\n        // of dataLayer and global gtag function.\r\n        // Detect if user has already put the gtag <script> tag on this page.\r\n        if (!findGtagScriptOnPage()) {\r\n            insertScriptTag(dataLayerName);\r\n        }\r\n        getOrCreateDataLayer(dataLayerName);\r\n        var _a = wrapOrCreateGtag(initializedIdPromisesMap, dataLayerName, gtagName), wrappedGtag = _a.wrappedGtag, gtagCore = _a.gtagCore;\r\n        wrappedGtagFunction = wrappedGtag;\r\n        gtagCoreFunction = gtagCore;\r\n        globalInitDone = true;\r\n    }\r\n    // Async but non-blocking.\r\n    initializedIdPromisesMap[analyticsId] = initializeGAId(app, installations, gtagCoreFunction);\r\n    var analyticsInstance = {\r\n        app: app,\r\n        logEvent: function (eventName, eventParams, options) {\r\n            return logEvent(wrappedGtagFunction, analyticsId, eventName, eventParams, options);\r\n        },\r\n        setCurrentScreen: function (screenName, options) {\r\n            return setCurrentScreen(wrappedGtagFunction, analyticsId, screenName, options);\r\n        },\r\n        setUserId: function (id, options) {\r\n            return setUserId(wrappedGtagFunction, analyticsId, id, options);\r\n        },\r\n        setUserProperties: function (properties, options) {\r\n            return setUserProperties(wrappedGtagFunction, analyticsId, properties, options);\r\n        },\r\n        setAnalyticsCollectionEnabled: function (enabled) {\r\n            return setAnalyticsCollectionEnabled(analyticsId, enabled);\r\n        }\r\n    };\r\n    return analyticsInstance;\r\n}\n\nvar name = \"@firebase/analytics\";\nvar version = \"0.3.3\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Type constant for Firebase Analytics.\r\n */\r\nvar ANALYTICS_TYPE = 'analytics';\r\nfunction registerAnalytics(instance) {\r\n    instance.INTERNAL.registerComponent(new Component(ANALYTICS_TYPE, function (container) {\r\n        // getImmediate for FirebaseApp will always succeed\r\n        var app = container.getProvider('app').getImmediate();\r\n        var installations = container\r\n            .getProvider('installations')\r\n            .getImmediate();\r\n        return factory(app, installations);\r\n    }, \"PUBLIC\" /* PUBLIC */).setServiceProps({\r\n        settings: settings,\r\n        EventName: EventName\r\n    }));\r\n    instance.INTERNAL.registerComponent(new Component('analytics-internal', internalFactory, \"PRIVATE\" /* PRIVATE */));\r\n    instance.registerVersion(name, version);\r\n    function internalFactory(container) {\r\n        try {\r\n            var analytics = container.getProvider(ANALYTICS_TYPE).getImmediate();\r\n            return {\r\n                logEvent: analytics.logEvent\r\n            };\r\n        }\r\n        catch (e) {\r\n            throw ERROR_FACTORY.create(\"interop-component-reg-failed\" /* INTEROP_COMPONENT_REG_FAILED */, {\r\n                reason: e\r\n            });\r\n        }\r\n    }\r\n}\r\nregisterAnalytics(firebase);\n\nexport { factory, getGlobalVars, registerAnalytics, resetGlobalVars, settings };\n//# sourceMappingURL=index.esm.js.map\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import firebase from '@firebase/app';\nimport { Component } from '@firebase/component';\nimport { __awaiter, __generator, __spread, __values, __assign } from 'tslib';\nimport { ErrorFactory, FirebaseError } from '@firebase/util';\nimport { openDb } from 'idb';\n\nvar name = \"@firebase/installations\";\nvar version = \"0.4.8\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar PENDING_TIMEOUT_MS = 10000;\r\nvar PACKAGE_VERSION = \"w:\" + version;\r\nvar INTERNAL_AUTH_VERSION = 'FIS_v2';\r\nvar INSTALLATIONS_API_URL = 'https://firebaseinstallations.googleapis.com/v1';\r\nvar TOKEN_EXPIRATION_BUFFER = 60 * 60 * 1000; // One hour\r\nvar SERVICE = 'installations';\r\nvar SERVICE_NAME = 'Installations';\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar _a;\r\nvar ERROR_DESCRIPTION_MAP = (_a = {},\r\n    _a[\"missing-app-config-values\" /* MISSING_APP_CONFIG_VALUES */] = 'Missing App configuration value: \"{$valueName}\"',\r\n    _a[\"not-registered\" /* NOT_REGISTERED */] = 'Firebase Installation is not registered.',\r\n    _a[\"installation-not-found\" /* INSTALLATION_NOT_FOUND */] = 'Firebase Installation not found.',\r\n    _a[\"request-failed\" /* REQUEST_FAILED */] = '{$requestName} request failed with error \"{$serverCode} {$serverStatus}: {$serverMessage}\"',\r\n    _a[\"app-offline\" /* APP_OFFLINE */] = 'Could not process request. Application offline.',\r\n    _a[\"delete-pending-registration\" /* DELETE_PENDING_REGISTRATION */] = \"Can't delete installation while there is a pending registration request.\",\r\n    _a);\r\nvar ERROR_FACTORY = new ErrorFactory(SERVICE, SERVICE_NAME, ERROR_DESCRIPTION_MAP);\r\n/** Returns true if error is a FirebaseError that is based on an error from the server. */\r\nfunction isServerError(error) {\r\n    return (error instanceof FirebaseError &&\r\n        error.code.includes(\"request-failed\" /* REQUEST_FAILED */));\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getInstallationsEndpoint(_a) {\r\n    var projectId = _a.projectId;\r\n    return INSTALLATIONS_API_URL + \"/projects/\" + projectId + \"/installations\";\r\n}\r\nfunction extractAuthTokenInfoFromResponse(response) {\r\n    return {\r\n        token: response.token,\r\n        requestStatus: 2 /* COMPLETED */,\r\n        expiresIn: getExpiresInFromResponseExpiresIn(response.expiresIn),\r\n        creationTime: Date.now()\r\n    };\r\n}\r\nfunction getErrorFromResponse(requestName, response) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var responseJson, errorData;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, response.json()];\r\n                case 1:\r\n                    responseJson = _a.sent();\r\n                    errorData = responseJson.error;\r\n                    return [2 /*return*/, ERROR_FACTORY.create(\"request-failed\" /* REQUEST_FAILED */, {\r\n                            requestName: requestName,\r\n                            serverCode: errorData.code,\r\n                            serverMessage: errorData.message,\r\n                            serverStatus: errorData.status\r\n                        })];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction getHeaders(_a) {\r\n    var apiKey = _a.apiKey;\r\n    return new Headers({\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\nfunction getHeadersWithAuth(appConfig, _a) {\r\n    var refreshToken = _a.refreshToken;\r\n    var headers = getHeaders(appConfig);\r\n    headers.append('Authorization', getAuthorizationHeader(refreshToken));\r\n    return headers;\r\n}\r\n/**\r\n * Calls the passed in fetch wrapper and returns the response.\r\n * If the returned response has a status of 5xx, re-runs the function once and\r\n * returns the response.\r\n */\r\nfunction retryIfServerError(fn) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var result;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, fn()];\r\n                case 1:\r\n                    result = _a.sent();\r\n                    if (result.status >= 500 && result.status < 600) {\r\n                        // Internal Server Error. Retry request.\r\n                        return [2 /*return*/, fn()];\r\n                    }\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction getExpiresInFromResponseExpiresIn(responseExpiresIn) {\r\n    // This works because the server will never respond with fractions of a second.\r\n    return Number(responseExpiresIn.replace('s', '000'));\r\n}\r\nfunction getAuthorizationHeader(refreshToken) {\r\n    return INTERNAL_AUTH_VERSION + \" \" + refreshToken;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction createInstallationRequest(appConfig, _a) {\r\n    var fid = _a.fid;\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var endpoint, headers, body, request, response, responseValue, registeredInstallationEntry;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    endpoint = getInstallationsEndpoint(appConfig);\r\n                    headers = getHeaders(appConfig);\r\n                    body = {\r\n                        fid: fid,\r\n                        authVersion: INTERNAL_AUTH_VERSION,\r\n                        appId: appConfig.appId,\r\n                        sdkVersion: PACKAGE_VERSION\r\n                    };\r\n                    request = {\r\n                        method: 'POST',\r\n                        headers: headers,\r\n                        body: JSON.stringify(body)\r\n                    };\r\n                    return [4 /*yield*/, retryIfServerError(function () { return fetch(endpoint, request); })];\r\n                case 1:\r\n                    response = _b.sent();\r\n                    if (!response.ok) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    responseValue = _b.sent();\r\n                    registeredInstallationEntry = {\r\n                        fid: responseValue.fid || fid,\r\n                        registrationStatus: 2 /* COMPLETED */,\r\n                        refreshToken: responseValue.refreshToken,\r\n                        authToken: extractAuthTokenInfoFromResponse(responseValue.authToken)\r\n                    };\r\n                    return [2 /*return*/, registeredInstallationEntry];\r\n                case 3: return [4 /*yield*/, getErrorFromResponse('Create Installation', response)];\r\n                case 4: throw _b.sent();\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a promise that resolves after given time passes. */\r\nfunction sleep(ms) {\r\n    return new Promise(function (resolve) {\r\n        setTimeout(resolve, ms);\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction bufferToBase64UrlSafe(array) {\r\n    var b64 = btoa(String.fromCharCode.apply(String, __spread(array)));\r\n    return b64.replace(/\\+/g, '-').replace(/\\//g, '_');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar VALID_FID_PATTERN = /^[cdef][\\w-]{21}$/;\r\nvar INVALID_FID = '';\r\n/**\r\n * Generates a new FID using random values from Web Crypto API.\r\n * Returns an empty string if FID generation fails for any reason.\r\n */\r\nfunction generateFid() {\r\n    try {\r\n        // A valid FID has exactly 22 base64 characters, which is 132 bits, or 16.5\r\n        // bytes. our implementation generates a 17 byte array instead.\r\n        var fidByteArray = new Uint8Array(17);\r\n        var crypto_1 = self.crypto || self.msCrypto;\r\n        crypto_1.getRandomValues(fidByteArray);\r\n        // Replace the first 4 random bits with the constant FID header of 0b0111.\r\n        fidByteArray[0] = 112 + (fidByteArray[0] % 16);\r\n        var fid = encode(fidByteArray);\r\n        return VALID_FID_PATTERN.test(fid) ? fid : INVALID_FID;\r\n    }\r\n    catch (_a) {\r\n        // FID generation errored\r\n        return INVALID_FID;\r\n    }\r\n}\r\n/** Converts a FID Uint8Array to a base64 string representation. */\r\nfunction encode(fidByteArray) {\r\n    var b64String = bufferToBase64UrlSafe(fidByteArray);\r\n    // Remove the 23rd character that was added because of the extra 4 bits at the\r\n    // end of our 17 byte array, and the '=' padding.\r\n    return b64String.substr(0, 22);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a string key that can be used to identify the app. */\r\nfunction getKey(appConfig) {\r\n    return appConfig.appName + \"!\" + appConfig.appId;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar fidChangeCallbacks = new Map();\r\n/**\r\n * Calls the onIdChange callbacks with the new FID value, and broadcasts the\r\n * change to other tabs.\r\n */\r\nfunction fidChanged(appConfig, fid) {\r\n    var key = getKey(appConfig);\r\n    callFidChangeCallbacks(key, fid);\r\n    broadcastFidChange(key, fid);\r\n}\r\nfunction addCallback(appConfig, callback) {\r\n    // Open the broadcast channel if it's not already open,\r\n    // to be able to listen to change events from other tabs.\r\n    getBroadcastChannel();\r\n    var key = getKey(appConfig);\r\n    var callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        callbackSet = new Set();\r\n        fidChangeCallbacks.set(key, callbackSet);\r\n    }\r\n    callbackSet.add(callback);\r\n}\r\nfunction removeCallback(appConfig, callback) {\r\n    var key = getKey(appConfig);\r\n    var callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        return;\r\n    }\r\n    callbackSet.delete(callback);\r\n    if (callbackSet.size === 0) {\r\n        fidChangeCallbacks.delete(key);\r\n    }\r\n    // Close broadcast channel if there are no more callbacks.\r\n    closeBroadcastChannel();\r\n}\r\nfunction callFidChangeCallbacks(key, fid) {\r\n    var e_1, _a;\r\n    var callbacks = fidChangeCallbacks.get(key);\r\n    if (!callbacks) {\r\n        return;\r\n    }\r\n    try {\r\n        for (var callbacks_1 = __values(callbacks), callbacks_1_1 = callbacks_1.next(); !callbacks_1_1.done; callbacks_1_1 = callbacks_1.next()) {\r\n            var callback = callbacks_1_1.value;\r\n            callback(fid);\r\n        }\r\n    }\r\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n    finally {\r\n        try {\r\n            if (callbacks_1_1 && !callbacks_1_1.done && (_a = callbacks_1.return)) _a.call(callbacks_1);\r\n        }\r\n        finally { if (e_1) throw e_1.error; }\r\n    }\r\n}\r\nfunction broadcastFidChange(key, fid) {\r\n    var channel = getBroadcastChannel();\r\n    if (channel) {\r\n        channel.postMessage({ key: key, fid: fid });\r\n    }\r\n    closeBroadcastChannel();\r\n}\r\nvar broadcastChannel = null;\r\n/** Opens and returns a BroadcastChannel if it is supported by the browser. */\r\nfunction getBroadcastChannel() {\r\n    if (!broadcastChannel && 'BroadcastChannel' in self) {\r\n        broadcastChannel = new BroadcastChannel('[Firebase] FID Change');\r\n        broadcastChannel.onmessage = function (e) {\r\n            callFidChangeCallbacks(e.data.key, e.data.fid);\r\n        };\r\n    }\r\n    return broadcastChannel;\r\n}\r\nfunction closeBroadcastChannel() {\r\n    if (fidChangeCallbacks.size === 0 && broadcastChannel) {\r\n        broadcastChannel.close();\r\n        broadcastChannel = null;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar DATABASE_NAME = 'firebase-installations-database';\r\nvar DATABASE_VERSION = 1;\r\nvar OBJECT_STORE_NAME = 'firebase-installations-store';\r\nvar dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDb(DATABASE_NAME, DATABASE_VERSION, function (upgradeDB) {\r\n            // We don't use 'break' in this switch statement, the fall-through\r\n            // behavior is what we want, because if there are multiple versions between\r\n            // the old version and the current version, we want ALL the migrations\r\n            // that correspond to those versions to run, not only the last one.\r\n            // eslint-disable-next-line default-case\r\n            switch (upgradeDB.oldVersion) {\r\n                case 0:\r\n                    upgradeDB.createObjectStore(OBJECT_STORE_NAME);\r\n            }\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\n/** Assigns or overwrites the record for the given key with the given value. */\r\nfunction set(appConfig, value) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var key, db, tx, objectStore, oldValue;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    key = getKey(appConfig);\r\n                    return [4 /*yield*/, getDbPromise()];\r\n                case 1:\r\n                    db = _a.sent();\r\n                    tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n                    objectStore = tx.objectStore(OBJECT_STORE_NAME);\r\n                    return [4 /*yield*/, objectStore.get(key)];\r\n                case 2:\r\n                    oldValue = _a.sent();\r\n                    return [4 /*yield*/, objectStore.put(value, key)];\r\n                case 3:\r\n                    _a.sent();\r\n                    return [4 /*yield*/, tx.complete];\r\n                case 4:\r\n                    _a.sent();\r\n                    if (!oldValue || oldValue.fid !== value.fid) {\r\n                        fidChanged(appConfig, value.fid);\r\n                    }\r\n                    return [2 /*return*/, value];\r\n            }\r\n        });\r\n    });\r\n}\r\n/** Removes record(s) from the objectStore that match the given key. */\r\nfunction remove(appConfig) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var key, db, tx;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    key = getKey(appConfig);\r\n                    return [4 /*yield*/, getDbPromise()];\r\n                case 1:\r\n                    db = _a.sent();\r\n                    tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n                    return [4 /*yield*/, tx.objectStore(OBJECT_STORE_NAME).delete(key)];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [4 /*yield*/, tx.complete];\r\n                case 3:\r\n                    _a.sent();\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Atomically updates a record with the result of updateFn, which gets\r\n * called with the current value. If newValue is undefined, the record is\r\n * deleted instead.\r\n * @return Updated value\r\n */\r\nfunction update(appConfig, updateFn) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var key, db, tx, store, oldValue, newValue;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    key = getKey(appConfig);\r\n                    return [4 /*yield*/, getDbPromise()];\r\n                case 1:\r\n                    db = _a.sent();\r\n                    tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n                    store = tx.objectStore(OBJECT_STORE_NAME);\r\n                    return [4 /*yield*/, store.get(key)];\r\n                case 2:\r\n                    oldValue = _a.sent();\r\n                    newValue = updateFn(oldValue);\r\n                    if (!(newValue === undefined)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, store.delete(key)];\r\n                case 3:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 6];\r\n                case 4: return [4 /*yield*/, store.put(newValue, key)];\r\n                case 5:\r\n                    _a.sent();\r\n                    _a.label = 6;\r\n                case 6: return [4 /*yield*/, tx.complete];\r\n                case 7:\r\n                    _a.sent();\r\n                    if (newValue && (!oldValue || oldValue.fid !== newValue.fid)) {\r\n                        fidChanged(appConfig, newValue.fid);\r\n                    }\r\n                    return [2 /*return*/, newValue];\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Updates and returns the InstallationEntry from the database.\r\n * Also triggers a registration request if it is necessary and possible.\r\n */\r\nfunction getInstallationEntry(appConfig) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var registrationPromise, installationEntry, _a;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, update(appConfig, function (oldEntry) {\r\n                        var installationEntry = updateOrCreateInstallationEntry(oldEntry);\r\n                        var entryWithPromise = triggerRegistrationIfNecessary(appConfig, installationEntry);\r\n                        registrationPromise = entryWithPromise.registrationPromise;\r\n                        return entryWithPromise.installationEntry;\r\n                    })];\r\n                case 1:\r\n                    installationEntry = _b.sent();\r\n                    if (!(installationEntry.fid === INVALID_FID)) return [3 /*break*/, 3];\r\n                    _a = {};\r\n                    return [4 /*yield*/, registrationPromise];\r\n                case 2: \r\n                // FID generation failed. Waiting for the FID from the server.\r\n                return [2 /*return*/, (_a.installationEntry = _b.sent(), _a)];\r\n                case 3: return [2 /*return*/, {\r\n                        installationEntry: installationEntry,\r\n                        registrationPromise: registrationPromise\r\n                    }];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Creates a new Installation Entry if one does not exist.\r\n * Also clears timed out pending requests.\r\n */\r\nfunction updateOrCreateInstallationEntry(oldEntry) {\r\n    var entry = oldEntry || {\r\n        fid: generateFid(),\r\n        registrationStatus: 0 /* NOT_STARTED */\r\n    };\r\n    return clearTimedOutRequest(entry);\r\n}\r\n/**\r\n * If the Firebase Installation is not registered yet, this will trigger the\r\n * registration and return an InProgressInstallationEntry.\r\n *\r\n * If registrationPromise does not exist, the installationEntry is guaranteed\r\n * to be registered.\r\n */\r\nfunction triggerRegistrationIfNecessary(appConfig, installationEntry) {\r\n    if (installationEntry.registrationStatus === 0 /* NOT_STARTED */) {\r\n        if (!navigator.onLine) {\r\n            // Registration required but app is offline.\r\n            var registrationPromiseWithError = Promise.reject(ERROR_FACTORY.create(\"app-offline\" /* APP_OFFLINE */));\r\n            return {\r\n                installationEntry: installationEntry,\r\n                registrationPromise: registrationPromiseWithError\r\n            };\r\n        }\r\n        // Try registering. Change status to IN_PROGRESS.\r\n        var inProgressEntry = {\r\n            fid: installationEntry.fid,\r\n            registrationStatus: 1 /* IN_PROGRESS */,\r\n            registrationTime: Date.now()\r\n        };\r\n        var registrationPromise = registerInstallation(appConfig, inProgressEntry);\r\n        return { installationEntry: inProgressEntry, registrationPromise: registrationPromise };\r\n    }\r\n    else if (installationEntry.registrationStatus === 1 /* IN_PROGRESS */) {\r\n        return {\r\n            installationEntry: installationEntry,\r\n            registrationPromise: waitUntilFidRegistration(appConfig)\r\n        };\r\n    }\r\n    else {\r\n        return { installationEntry: installationEntry };\r\n    }\r\n}\r\n/** This will be executed only once for each new Firebase Installation. */\r\nfunction registerInstallation(appConfig, installationEntry) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var registeredInstallationEntry, e_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    _a.trys.push([0, 2, , 7]);\r\n                    return [4 /*yield*/, createInstallationRequest(appConfig, installationEntry)];\r\n                case 1:\r\n                    registeredInstallationEntry = _a.sent();\r\n                    return [2 /*return*/, set(appConfig, registeredInstallationEntry)];\r\n                case 2:\r\n                    e_1 = _a.sent();\r\n                    if (!(isServerError(e_1) && e_1.serverCode === 409)) return [3 /*break*/, 4];\r\n                    // Server returned a \"FID can not be used\" error.\r\n                    // Generate a new ID next time.\r\n                    return [4 /*yield*/, remove(appConfig)];\r\n                case 3:\r\n                    // Server returned a \"FID can not be used\" error.\r\n                    // Generate a new ID next time.\r\n                    _a.sent();\r\n                    return [3 /*break*/, 6];\r\n                case 4: \r\n                // Registration failed. Set FID as not registered.\r\n                return [4 /*yield*/, set(appConfig, {\r\n                        fid: installationEntry.fid,\r\n                        registrationStatus: 0 /* NOT_STARTED */\r\n                    })];\r\n                case 5:\r\n                    // Registration failed. Set FID as not registered.\r\n                    _a.sent();\r\n                    _a.label = 6;\r\n                case 6: throw e_1;\r\n                case 7: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/** Call if FID registration is pending in another request. */\r\nfunction waitUntilFidRegistration(appConfig) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var entry, _a, installationEntry, registrationPromise;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, updateInstallationRequest(appConfig)];\r\n                case 1:\r\n                    entry = _b.sent();\r\n                    _b.label = 2;\r\n                case 2:\r\n                    if (!(entry.registrationStatus === 1 /* IN_PROGRESS */)) return [3 /*break*/, 5];\r\n                    // createInstallation request still in progress.\r\n                    return [4 /*yield*/, sleep(100)];\r\n                case 3:\r\n                    // createInstallation request still in progress.\r\n                    _b.sent();\r\n                    return [4 /*yield*/, updateInstallationRequest(appConfig)];\r\n                case 4:\r\n                    entry = _b.sent();\r\n                    return [3 /*break*/, 2];\r\n                case 5:\r\n                    if (!(entry.registrationStatus === 0 /* NOT_STARTED */)) return [3 /*break*/, 7];\r\n                    return [4 /*yield*/, getInstallationEntry(appConfig)];\r\n                case 6:\r\n                    _a = _b.sent(), installationEntry = _a.installationEntry, registrationPromise = _a.registrationPromise;\r\n                    if (registrationPromise) {\r\n                        return [2 /*return*/, registrationPromise];\r\n                    }\r\n                    else {\r\n                        // if there is no registrationPromise, entry is registered.\r\n                        return [2 /*return*/, installationEntry];\r\n                    }\r\n                case 7: return [2 /*return*/, entry];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Called only if there is a CreateInstallation request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * CreateInstallation request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateInstallationRequest(appConfig) {\r\n    return update(appConfig, function (oldEntry) {\r\n        if (!oldEntry) {\r\n            throw ERROR_FACTORY.create(\"installation-not-found\" /* INSTALLATION_NOT_FOUND */);\r\n        }\r\n        return clearTimedOutRequest(oldEntry);\r\n    });\r\n}\r\nfunction clearTimedOutRequest(entry) {\r\n    if (hasInstallationRequestTimedOut(entry)) {\r\n        return {\r\n            fid: entry.fid,\r\n            registrationStatus: 0 /* NOT_STARTED */\r\n        };\r\n    }\r\n    return entry;\r\n}\r\nfunction hasInstallationRequestTimedOut(installationEntry) {\r\n    return (installationEntry.registrationStatus === 1 /* IN_PROGRESS */ &&\r\n        installationEntry.registrationTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction generateAuthTokenRequest(_a, installationEntry) {\r\n    var appConfig = _a.appConfig, platformLoggerProvider = _a.platformLoggerProvider;\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var endpoint, headers, platformLogger, body, request, response, responseValue, completedAuthToken;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    endpoint = getGenerateAuthTokenEndpoint(appConfig, installationEntry);\r\n                    headers = getHeadersWithAuth(appConfig, installationEntry);\r\n                    platformLogger = platformLoggerProvider.getImmediate({\r\n                        optional: true\r\n                    });\r\n                    if (platformLogger) {\r\n                        headers.append('x-firebase-client', platformLogger.getPlatformInfoString());\r\n                    }\r\n                    body = {\r\n                        installation: {\r\n                            sdkVersion: PACKAGE_VERSION\r\n                        }\r\n                    };\r\n                    request = {\r\n                        method: 'POST',\r\n                        headers: headers,\r\n                        body: JSON.stringify(body)\r\n                    };\r\n                    return [4 /*yield*/, retryIfServerError(function () { return fetch(endpoint, request); })];\r\n                case 1:\r\n                    response = _b.sent();\r\n                    if (!response.ok) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, response.json()];\r\n                case 2:\r\n                    responseValue = _b.sent();\r\n                    completedAuthToken = extractAuthTokenInfoFromResponse(responseValue);\r\n                    return [2 /*return*/, completedAuthToken];\r\n                case 3: return [4 /*yield*/, getErrorFromResponse('Generate Auth Token', response)];\r\n                case 4: throw _b.sent();\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction getGenerateAuthTokenEndpoint(appConfig, _a) {\r\n    var fid = _a.fid;\r\n    return getInstallationsEndpoint(appConfig) + \"/\" + fid + \"/authTokens:generate\";\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a valid authentication token for the installation. Generates a new\r\n * token if one doesn't exist, is expired or about to expire.\r\n *\r\n * Should only be called if the Firebase Installation is registered.\r\n */\r\nfunction refreshAuthToken(dependencies, forceRefresh) {\r\n    if (forceRefresh === void 0) { forceRefresh = false; }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var tokenPromise, entry, authToken, _a;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, update(dependencies.appConfig, function (oldEntry) {\r\n                        if (!isEntryRegistered(oldEntry)) {\r\n                            throw ERROR_FACTORY.create(\"not-registered\" /* NOT_REGISTERED */);\r\n                        }\r\n                        var oldAuthToken = oldEntry.authToken;\r\n                        if (!forceRefresh && isAuthTokenValid(oldAuthToken)) {\r\n                            // There is a valid token in the DB.\r\n                            return oldEntry;\r\n                        }\r\n                        else if (oldAuthToken.requestStatus === 1 /* IN_PROGRESS */) {\r\n                            // There already is a token request in progress.\r\n                            tokenPromise = waitUntilAuthTokenRequest(dependencies, forceRefresh);\r\n                            return oldEntry;\r\n                        }\r\n                        else {\r\n                            // No token or token expired.\r\n                            if (!navigator.onLine) {\r\n                                throw ERROR_FACTORY.create(\"app-offline\" /* APP_OFFLINE */);\r\n                            }\r\n                            var inProgressEntry = makeAuthTokenRequestInProgressEntry(oldEntry);\r\n                            tokenPromise = fetchAuthTokenFromServer(dependencies, inProgressEntry);\r\n                            return inProgressEntry;\r\n                        }\r\n                    })];\r\n                case 1:\r\n                    entry = _b.sent();\r\n                    if (!tokenPromise) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, tokenPromise];\r\n                case 2:\r\n                    _a = _b.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    _a = entry.authToken;\r\n                    _b.label = 4;\r\n                case 4:\r\n                    authToken = _a;\r\n                    return [2 /*return*/, authToken];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Call only if FID is registered and Auth Token request is in progress.\r\n *\r\n * Waits until the current pending request finishes. If the request times out,\r\n * tries once in this thread as well.\r\n */\r\nfunction waitUntilAuthTokenRequest(dependencies, forceRefresh) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var entry, authToken;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, updateAuthTokenRequest(dependencies.appConfig)];\r\n                case 1:\r\n                    entry = _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    if (!(entry.authToken.requestStatus === 1 /* IN_PROGRESS */)) return [3 /*break*/, 5];\r\n                    // generateAuthToken still in progress.\r\n                    return [4 /*yield*/, sleep(100)];\r\n                case 3:\r\n                    // generateAuthToken still in progress.\r\n                    _a.sent();\r\n                    return [4 /*yield*/, updateAuthTokenRequest(dependencies.appConfig)];\r\n                case 4:\r\n                    entry = _a.sent();\r\n                    return [3 /*break*/, 2];\r\n                case 5:\r\n                    authToken = entry.authToken;\r\n                    if (authToken.requestStatus === 0 /* NOT_STARTED */) {\r\n                        // The request timed out or failed in a different call. Try again.\r\n                        return [2 /*return*/, refreshAuthToken(dependencies, forceRefresh)];\r\n                    }\r\n                    else {\r\n                        return [2 /*return*/, authToken];\r\n                    }\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Called only if there is a GenerateAuthToken request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * GenerateAuthToken request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateAuthTokenRequest(appConfig) {\r\n    return update(appConfig, function (oldEntry) {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* NOT_REGISTERED */);\r\n        }\r\n        var oldAuthToken = oldEntry.authToken;\r\n        if (hasAuthTokenRequestTimedOut(oldAuthToken)) {\r\n            return __assign(__assign({}, oldEntry), { authToken: { requestStatus: 0 /* NOT_STARTED */ } });\r\n        }\r\n        return oldEntry;\r\n    });\r\n}\r\nfunction fetchAuthTokenFromServer(dependencies, installationEntry) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var authToken, updatedInstallationEntry, e_1, updatedInstallationEntry;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    _a.trys.push([0, 3, , 8]);\r\n                    return [4 /*yield*/, generateAuthTokenRequest(dependencies, installationEntry)];\r\n                case 1:\r\n                    authToken = _a.sent();\r\n                    updatedInstallationEntry = __assign(__assign({}, installationEntry), { authToken: authToken });\r\n                    return [4 /*yield*/, set(dependencies.appConfig, updatedInstallationEntry)];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [2 /*return*/, authToken];\r\n                case 3:\r\n                    e_1 = _a.sent();\r\n                    if (!(isServerError(e_1) && (e_1.serverCode === 401 || e_1.serverCode === 404))) return [3 /*break*/, 5];\r\n                    // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\r\n                    // Generate a new ID next time.\r\n                    return [4 /*yield*/, remove(dependencies.appConfig)];\r\n                case 4:\r\n                    // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\r\n                    // Generate a new ID next time.\r\n                    _a.sent();\r\n                    return [3 /*break*/, 7];\r\n                case 5:\r\n                    updatedInstallationEntry = __assign(__assign({}, installationEntry), { authToken: { requestStatus: 0 /* NOT_STARTED */ } });\r\n                    return [4 /*yield*/, set(dependencies.appConfig, updatedInstallationEntry)];\r\n                case 6:\r\n                    _a.sent();\r\n                    _a.label = 7;\r\n                case 7: throw e_1;\r\n                case 8: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction isEntryRegistered(installationEntry) {\r\n    return (installationEntry !== undefined &&\r\n        installationEntry.registrationStatus === 2 /* COMPLETED */);\r\n}\r\nfunction isAuthTokenValid(authToken) {\r\n    return (authToken.requestStatus === 2 /* COMPLETED */ &&\r\n        !isAuthTokenExpired(authToken));\r\n}\r\nfunction isAuthTokenExpired(authToken) {\r\n    var now = Date.now();\r\n    return (now < authToken.creationTime ||\r\n        authToken.creationTime + authToken.expiresIn < now + TOKEN_EXPIRATION_BUFFER);\r\n}\r\n/** Returns an updated InstallationEntry with an InProgressAuthToken. */\r\nfunction makeAuthTokenRequestInProgressEntry(oldEntry) {\r\n    var inProgressAuthToken = {\r\n        requestStatus: 1 /* IN_PROGRESS */,\r\n        requestTime: Date.now()\r\n    };\r\n    return __assign(__assign({}, oldEntry), { authToken: inProgressAuthToken });\r\n}\r\nfunction hasAuthTokenRequestTimedOut(authToken) {\r\n    return (authToken.requestStatus === 1 /* IN_PROGRESS */ &&\r\n        authToken.requestTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getId(dependencies) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _a, installationEntry, registrationPromise;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, getInstallationEntry(dependencies.appConfig)];\r\n                case 1:\r\n                    _a = _b.sent(), installationEntry = _a.installationEntry, registrationPromise = _a.registrationPromise;\r\n                    if (registrationPromise) {\r\n                        registrationPromise.catch(console.error);\r\n                    }\r\n                    else {\r\n                        // If the installation is already registered, update the authentication\r\n                        // token if needed.\r\n                        refreshAuthToken(dependencies).catch(console.error);\r\n                    }\r\n                    return [2 /*return*/, installationEntry.fid];\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getToken(dependencies, forceRefresh) {\r\n    if (forceRefresh === void 0) { forceRefresh = false; }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var authToken;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, completeInstallationRegistration(dependencies.appConfig)];\r\n                case 1:\r\n                    _a.sent();\r\n                    return [4 /*yield*/, refreshAuthToken(dependencies, forceRefresh)];\r\n                case 2:\r\n                    authToken = _a.sent();\r\n                    return [2 /*return*/, authToken.token];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction completeInstallationRegistration(appConfig) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var registrationPromise;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, getInstallationEntry(appConfig)];\r\n                case 1:\r\n                    registrationPromise = (_a.sent()).registrationPromise;\r\n                    if (!registrationPromise) return [3 /*break*/, 3];\r\n                    // A createInstallation request is in progress. Wait until it finishes.\r\n                    return [4 /*yield*/, registrationPromise];\r\n                case 2:\r\n                    // A createInstallation request is in progress. Wait until it finishes.\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction deleteInstallationRequest(appConfig, installationEntry) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var endpoint, headers, request, response;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    endpoint = getDeleteEndpoint(appConfig, installationEntry);\r\n                    headers = getHeadersWithAuth(appConfig, installationEntry);\r\n                    request = {\r\n                        method: 'DELETE',\r\n                        headers: headers\r\n                    };\r\n                    return [4 /*yield*/, retryIfServerError(function () { return fetch(endpoint, request); })];\r\n                case 1:\r\n                    response = _a.sent();\r\n                    if (!!response.ok) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, getErrorFromResponse('Delete Installation', response)];\r\n                case 2: throw _a.sent();\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction getDeleteEndpoint(appConfig, _a) {\r\n    var fid = _a.fid;\r\n    return getInstallationsEndpoint(appConfig) + \"/\" + fid;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction deleteInstallation(dependencies) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var appConfig, entry;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    appConfig = dependencies.appConfig;\r\n                    return [4 /*yield*/, update(appConfig, function (oldEntry) {\r\n                            if (oldEntry && oldEntry.registrationStatus === 0 /* NOT_STARTED */) {\r\n                                // Delete the unregistered entry without sending a deleteInstallation request.\r\n                                return undefined;\r\n                            }\r\n                            return oldEntry;\r\n                        })];\r\n                case 1:\r\n                    entry = _a.sent();\r\n                    if (!entry) return [3 /*break*/, 6];\r\n                    if (!(entry.registrationStatus === 1 /* IN_PROGRESS */)) return [3 /*break*/, 2];\r\n                    // Can't delete while trying to register.\r\n                    throw ERROR_FACTORY.create(\"delete-pending-registration\" /* DELETE_PENDING_REGISTRATION */);\r\n                case 2:\r\n                    if (!(entry.registrationStatus === 2 /* COMPLETED */)) return [3 /*break*/, 6];\r\n                    if (!!navigator.onLine) return [3 /*break*/, 3];\r\n                    throw ERROR_FACTORY.create(\"app-offline\" /* APP_OFFLINE */);\r\n                case 3: return [4 /*yield*/, deleteInstallationRequest(appConfig, entry)];\r\n                case 4:\r\n                    _a.sent();\r\n                    return [4 /*yield*/, remove(appConfig)];\r\n                case 5:\r\n                    _a.sent();\r\n                    _a.label = 6;\r\n                case 6: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Sets a new callback that will get called when Installation ID changes.\r\n * Returns an unsubscribe function that will remove the callback when called.\r\n */\r\nfunction onIdChange(_a, callback) {\r\n    var appConfig = _a.appConfig;\r\n    addCallback(appConfig, callback);\r\n    return function () {\r\n        removeCallback(appConfig, callback);\r\n    };\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction extractAppConfig(app) {\r\n    var e_1, _a;\r\n    if (!app || !app.options) {\r\n        throw getMissingValueError('App Configuration');\r\n    }\r\n    if (!app.name) {\r\n        throw getMissingValueError('App Name');\r\n    }\r\n    // Required app config keys\r\n    var configKeys = [\r\n        'projectId',\r\n        'apiKey',\r\n        'appId'\r\n    ];\r\n    try {\r\n        for (var configKeys_1 = __values(configKeys), configKeys_1_1 = configKeys_1.next(); !configKeys_1_1.done; configKeys_1_1 = configKeys_1.next()) {\r\n            var keyName = configKeys_1_1.value;\r\n            if (!app.options[keyName]) {\r\n                throw getMissingValueError(keyName);\r\n            }\r\n        }\r\n    }\r\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n    finally {\r\n        try {\r\n            if (configKeys_1_1 && !configKeys_1_1.done && (_a = configKeys_1.return)) _a.call(configKeys_1);\r\n        }\r\n        finally { if (e_1) throw e_1.error; }\r\n    }\r\n    return {\r\n        appName: app.name,\r\n        projectId: app.options.projectId,\r\n        apiKey: app.options.apiKey,\r\n        appId: app.options.appId\r\n    };\r\n}\r\nfunction getMissingValueError(valueName) {\r\n    return ERROR_FACTORY.create(\"missing-app-config-values\" /* MISSING_APP_CONFIG_VALUES */, {\r\n        valueName: valueName\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google Inc.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction registerInstallations(instance) {\r\n    var installationsName = 'installations';\r\n    instance.INTERNAL.registerComponent(new Component(installationsName, function (container) {\r\n        var app = container.getProvider('app').getImmediate();\r\n        // Throws if app isn't configured properly.\r\n        var appConfig = extractAppConfig(app);\r\n        var platformLoggerProvider = container.getProvider('platform-logger');\r\n        var dependencies = {\r\n            appConfig: appConfig,\r\n            platformLoggerProvider: platformLoggerProvider\r\n        };\r\n        var installations = {\r\n            app: app,\r\n            getId: function () { return getId(dependencies); },\r\n            getToken: function (forceRefresh) {\r\n                return getToken(dependencies, forceRefresh);\r\n            },\r\n            delete: function () { return deleteInstallation(dependencies); },\r\n            onIdChange: function (callback) {\r\n                return onIdChange(dependencies, callback);\r\n            }\r\n        };\r\n        return installations;\r\n    }, \"PUBLIC\" /* PUBLIC */));\r\n    instance.registerVersion(name, version);\r\n}\r\nregisterInstallations(firebase);\n\nexport { registerInstallations };\n//# sourceMappingURL=index.esm.js.map\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import '@firebase/analytics';\n//# sourceMappingURL=index.esm.js.map\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = global || self, factory(global.idb = {}));\n}(this, function (exports) { 'use strict';\n\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  function openDb(name, version, upgradeCallback) {\n    var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n    var request = p.request;\n\n    if (request) {\n      request.onupgradeneeded = function(event) {\n        if (upgradeCallback) {\n          upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n        }\n      };\n    }\n\n    return p.then(function(db) {\n      return new DB(db);\n    });\n  }\n\n  function deleteDb(name) {\n    return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n  }\n\n  exports.openDb = openDb;\n  exports.deleteDb = deleteDb;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n"]}